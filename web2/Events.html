<!DOCTYPE html>
<html lang="en">

<head>
  <title>LSSD Custom Cars</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="jquery/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="css/stylesheet.css">
  <script type="text/javascript" src="scripts/scripts.js"></script>
  <script src="popperJS/popper.min.js"></script>
  <script src="Bootstrap/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="Bootstrap/css/bootstrap.min.css">
</head>


<!-- Navbar -->

<body style="background-color: #282c34">
  <nav class="navbar navbar-expand-md  navbar-dark">
    <div class="navbar-brand"><a href="index.html"><img id="logo" src="img/logo.png" alt="logo.png"></a></div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="Konfigurator.html">Autos</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="Events.html">Events</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="Kontakt.html">Kontakt</a>
        </li>
        <li class="nav-item">
          <div class="container" id="shopping_cart">
            <img id="shopping_cart" src="./img/shopping_cart_white.png" alt="Warenkorb" data-html="true"
              data-toggle="popover" data-placement="bottom" title='<h1>Warenkorb</h1>' data-content="<div> <p>Audi RS3 Sportback<br><br> 
              Farbe: Tango Rot<br> Motor: 2.5 TFSI<br> Fahrwerk: KW<br> Sportfelgen: BBS<br> Update: Updatestufe 1 <br><br>  
              <B>Endpreis: 73083,48€ <br><br></B>   
              <a class='btn btn-primary' href='Bestellformular.html' role='button'>Bestellen</a> </div>">
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Formular -->
  <div class="container_Events" id="Events_Margin_Top">
    <div class="row">
      <div class="col-md-4" id="Event_image"><img class="img-fluid" src="img/events.jpg" alt="events.jpg"></img></div>
      <div class="col-md-6" id="Event_Form">
        <h2 id="Event_h1">Mit etwas Glück zu unseren Events!</h2>
        <p id=Event_text>
          Da die Karten zu unseren Events innerhalb von wenigen Minuten komplett ausverkauft sind, habe wir uns dazu
          entschlossen,
          die Karten von Anfang an zu verlosen. Fülle also jetzt das Formular aus und sei mit etwas Glück bei einem
          unserer nächsten
          Events dabei.
        </p>
        <form method="POST" enctype="multipart/form-data" id="myform" class="needs-validation" novalidate method="post"
          id="BookPackageForm"></form>>
        <div class="form-row">
          <div class="form-group col-md-4">
            <select id="inputState" class="form-control">
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-4">
            <label id="Event_Form_Text">Name</label>
            <span style="color:red">*</span>
            <input type="text" class="form-control" id="name" required>
          </div>
          <div class="form-group col-md-4">
            <label id="Event_Form_Text">Vorname</label>
            <span style="color:red">*</span>
            <input type="text" class="form-control" id="vname" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-4">
            <label id="Event_Form_Text">E-Mail</label>
            <span style="color:red">*</span>
            <input type="text" class="form-control" id="email" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-8">
            <label for="validationDefault03" id="Event_Form_Text">Adresse</label>
            <input type="text" id="adr" class="form-control">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-2">
            <label id="Event_Form_Text">PLZ</label>
            <input type="text" id="plz" class="form-control">
          </div>
          <div class="form-group col-md-4">
            <label id="Event_Form_Text">Ort</label>
            <input type="text" id="Ort" class="form-control">
            </select>
          </div>
          <div class="form-group col-md-4"></div>
          <div class="form-group col-md-2">
            <a class="btn btn-success" type="submit"  id="Event_button"
              role="button">Absenden</a>
          </div>
        </div>
        </form>
      </div>
      <div class="col-md-2"></div>
    </div>
  </div>


  <!-- Footer -->
  <footer>
    <div class="row ">
      <div class="col-md-1">
      </div>
      <div class="col-md-3">
        <p class="footer_head"><b>Über uns</b></p>
        <p class="footer_text" style="font-size:18px">
          LSSD Custom Cars ist ein junges und dynamisches Unternehmen mit dem Hauptsitz in Albstadt-Ebingen.
          Unser Unternehmen besteht aus 10 Mitarbeitern, die im Verkauf, Beratung und der Werkstatt tätig sind.
          Dabei ist es unser Ziel Ihnen ausgewählte Autos anzubieten, die sie individuell konfigurieren können.
        </p>
      </div>
      <div class="col-md-3">
        <p class="footer_head"><b>Neuigkeiten</b></p>
        <p class="footer_text" style="font-size:18px">
          Mometan können wir Ihnen auf Grund der aktuellen Lage nur ein eingeschränktes Angebot
          an Autos anbieten.<br><br>
          Wir bitten um Entschuldigung und hoffen, dass wir Ihnen bald möglichst wieder unser volles Angebot bieten
          können.
        </p>
      </div>
      <div class="col-md-3">
        <p class="footer_head"><b>Kontakt</b></p>
        <p class="footer_text" style="font-size:18px">
          LSSD Custom Cars<br>
          Poststraße 6<br>
          72458 Albstadt<br>
          07571/445566<br><br>
          <a href='Kontakt.html'>Kontakt/Termin</a>
          <br>
          <a href='impressum.html'>Impressum</a>
        </p>
      </div>
      <div class="col-md-2">
      </div>
    </div>
  </footer>

  <script>


    $(document).ready(function () {
      $('[data-toggle="popover"]').popover();
    });

    $("#inputState").ready(function() {
            console.log("button geterror clicked");

            $.ajax({
                url: "http://localhost:8000/api/events/dropDown",
                method: "get",
                dataType: "json"
            }).done(function (response) {
                console.log(response);
                $.each(response.daten, function (key, value) {
            $("#inputState").append($('<option></option>').val(value.events_id).text(value.events_name));
            console.log(document.getElementById("inputState").value);
        });
            }).fail(function (jqXHR, statusText, error) {
                console.log("Response Code: " + jqXHR.status + " - Fehlermeldung: " + jqXHR.responseText);
                $("#inputState").html("Ein Fehler ist aufgetreten");
            });
        });

    function link(){
      window.open('Formularbestaetigung.html','_self',false);
    }

    $("#Event_button").click(function () {

      console.log("button addtax clicked");
      var event_name = document.getElementById('inputState').value;
      var name = document.getElementById('name').value;
      var vname = document.getElementById('vname').value;
      var email = document.getElementById('email').value;
      var adr = document.getElementById('adr').value;
      var plz = document.getElementById('plz').value;
      var ort = document.getElementById('Ort').value;
      console.log(event_name,name,vname,email,adr,plz,ort);
      // var obj = { "event": event, "name": name, "vname": vname, "email": email, "adr": adr, "plz": plz, "ort": ort };
      var obj = { "f_event_id": event_name, "name": name, "vname": vname, "email": email, "adr": adr, "plz": parseInt(plz), "ort": ort };

      if(name.length>=3 &&vname.length>=3 &&email.length >=6){
        console.log("Erfolgreich")
        $.ajax({
          url: "http://localhost:8000/api/events",
          method: "post",
          contentType: "application/json",
          data: JSON.stringify(obj)
        }).done(function (response) {
          console.log(response);
          $("#output").html(JSON.stringify(response));
        }).fail(function (jqXHR, statusText, error) {
          console.log("Response Code: " + jqXHR.status + " - Fehlermeldung: " + jqXHR.responseText);
          $("#output").html("Ein Fehler ist aufgetreten");
        });
        setTimeout(link, 500);
        
      }else{
       alert("Eingabe Falsch. Name, Vorname oder Mail sind zu kurz oder nicht vorhanden.")
      }
      


      // window.alert("Break");
    });
    

  </script>
</body>

</html>